CREATE OR ALTER TABLE SF_METRICS.DYNAMIC_TABLE_REFRESH_HISTORY (
  LOGDATE DATE
  , NAME VARCHAR
  , SCHEMA_NAME VARCHAR
  , DATABASE_NAME VARCHAR
  , ID INTEGER
  , SCHEMA_ID INTEGER
  , DATABASE_ID INTEGER
  , STATE VARCHAR
  , STATE_CODE VARCHAR
  , STATE_MESSAGE VARCHAR
  , QUERY_ID VARCHAR
  , DATA_TIMESTAMP TIMESTAMP_LTZ
  , REFRESH_START_TIME TIMESTAMP_LTZ
  , REFRESH_END_TIME TIMESTAMP_LTZ
  , COMPLETION_TARGET TIMESTAMP_LTZ
  , QUALIFIED_NAME VARCHAR
  , LAST_COMPLETED_DEPENDENCY OBJECT
  , STATISTICS OBJECT
  , REFRESH_ACTION VARCHAR
  , REFRESH_TRIGGER VARCHAR
  , TARGET_LAG_SEC INTEGER
  , GRAPH_HISTORY_VALID_FROM TIMESTAMP_LTZ
)
COMMENT = 'Archive of SNOWFLAKE.ACCOUNT_USAGE.DYNAMIC_TABLE_REFRESH_HISTORY'
;
